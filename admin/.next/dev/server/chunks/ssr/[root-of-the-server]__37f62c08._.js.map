{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///C:/Prom/mvp-roc/admin/app/lib/api.ts"],"sourcesContent":["const BACKEND_URL = process.env.NEXT_PUBLIC_BACKEND_URL || \"http://localhost:3001\";\n\nclass AdminApiClient {\n  private baseUrl: string;\n\n  constructor(baseUrl: string) {\n    this.baseUrl = baseUrl;\n  }\n\n  private getToken(): string | null {\n    if (typeof window === \"undefined\") return null;\n    return localStorage.getItem(\"admin_token\");\n  }\n\n  setToken(token: string, userId: string, userName: string, role: string) {\n    if (typeof window === \"undefined\") return;\n    localStorage.setItem(\"admin_token\", token);\n    localStorage.setItem(\"admin_id\", userId);\n    localStorage.setItem(\"admin_name\", userName);\n    localStorage.setItem(\"admin_role\", role);\n    // Cookie para middleware\n    document.cookie = `admin_token=${token}; path=/; max-age=${7 * 24 * 60 * 60}; SameSite=Lax`;\n  }\n\n  clearAuth() {\n    if (typeof window === \"undefined\") return;\n    localStorage.removeItem(\"admin_token\");\n    localStorage.removeItem(\"admin_id\");\n    localStorage.removeItem(\"admin_name\");\n    localStorage.removeItem(\"admin_role\");\n    document.cookie = \"admin_token=; path=/; max-age=0\";\n  }\n\n  isAuthenticated(): boolean {\n    return !!this.getToken();\n  }\n\n  getAdminName(): string {\n    if (typeof window === \"undefined\") return \"\";\n    return localStorage.getItem(\"admin_name\") || \"Admin\";\n  }\n\n  getAdminRole(): string {\n    if (typeof window === \"undefined\") return \"\";\n    return localStorage.getItem(\"admin_role\") || \"admin\";\n  }\n\n  private async request<T>(endpoint: string, options: RequestInit = {}): Promise<T> {\n    const token = this.getToken();\n    const headers: Record<string, string> = {\n      \"Content-Type\": \"application/json\",\n      ...(token ? { Authorization: `Bearer ${token}` } : {}),\n    };\n\n    const response = await fetch(`${this.baseUrl}${endpoint}`, {\n      ...options,\n      headers,\n    });\n\n    let data: any;\n    try {\n      data = await response.json();\n    } catch {\n      data = { message: \"Erro ao processar resposta\" };\n    }\n\n    if (!response.ok) {\n      if (response.status === 401) {\n        this.clearAuth();\n        if (typeof window !== \"undefined\") {\n          window.location.href = \"/login\";\n        }\n      }\n      throw { message: data?.message || `Erro ${response.status}`, status: response.status };\n    }\n\n    return data;\n  }\n\n  // Auth\n  async login(email: string, password: string) {\n    const data = await this.request<{\n      user: { id: string; name: string; email: string; role: string };\n      token: string;\n    }>(\"/auth/login\", {\n      method: \"POST\",\n      body: JSON.stringify({ email, password }),\n    });\n\n    if (!data.user.role || ![\"admin\", \"super_admin\"].includes(data.user.role)) {\n      throw { message: \"Acesso restrito a administradores\", status: 403 };\n    }\n\n    this.setToken(data.token, data.user.id, data.user.name || \"Admin\", data.user.role);\n    return data;\n  }\n\n  // Dashboard\n  async getDashboard() {\n    return this.request<{\n      totalUsers: number;\n      activePasses: number;\n      estimatedRevenue: number;\n      vouchers: { total: number; available: number; used: number; expired: number };\n      recentValidations: any[];\n    }>(\"/admin/dashboard\");\n  }\n\n  // Users\n  async getUsers(params?: { page?: number; limit?: number; search?: string; status?: string }) {\n    const query = new URLSearchParams();\n    if (params?.page) query.set(\"page\", params.page.toString());\n    if (params?.limit) query.set(\"limit\", params.limit.toString());\n    if (params?.search) query.set(\"search\", params.search);\n    if (params?.status) query.set(\"status\", params.status);\n    return this.request<{ data: any[]; total: number; page: number; totalPages: number }>(\n      `/admin/users?${query}`\n    );\n  }\n\n  async getUserDetail(id: string) {\n    return this.request<any>(`/admin/users/${id}`);\n  }\n\n  async suspendUser(id: string) {\n    return this.request<{ message: string }>(`/admin/users/${id}/suspend`, { method: \"POST\" });\n  }\n\n  async activateUser(id: string) {\n    return this.request<{ message: string }>(`/admin/users/${id}/activate`, { method: \"POST\" });\n  }\n\n  // Restaurants\n  async getRestaurants(params?: { page?: number; limit?: number; search?: string; active?: string }) {\n    const query = new URLSearchParams();\n    if (params?.page) query.set(\"page\", params.page.toString());\n    if (params?.limit) query.set(\"limit\", params.limit.toString());\n    if (params?.search) query.set(\"search\", params.search);\n    if (params?.active) query.set(\"active\", params.active);\n    return this.request<{ data: any[]; total: number; page: number; totalPages: number }>(\n      `/admin/restaurants?${query}`\n    );\n  }\n\n  async createRestaurant(data: { name: string; city: string; discount_label: string; image_url?: string; category?: string; description?: string }) {\n    return this.request<any>(\"/admin/restaurants\", { method: \"POST\", body: JSON.stringify(data) });\n  }\n\n  async updateRestaurant(id: number, data: any) {\n    return this.request<any>(`/admin/restaurants/${id}`, { method: \"PUT\", body: JSON.stringify(data) });\n  }\n\n  async toggleRestaurant(id: number) {\n    return this.request<any>(`/admin/restaurants/${id}/toggle`, { method: \"PATCH\" });\n  }\n\n  // Vouchers\n  async getVouchers(params?: { page?: number; limit?: number; status?: string; search?: string; user_id?: string; restaurant_id?: string }) {\n    const query = new URLSearchParams();\n    if (params?.page) query.set(\"page\", params.page.toString());\n    if (params?.limit) query.set(\"limit\", params.limit.toString());\n    if (params?.status) query.set(\"status\", params.status);\n    if (params?.search) query.set(\"search\", params.search);\n    if (params?.user_id) query.set(\"user_id\", params.user_id);\n    if (params?.restaurant_id) query.set(\"restaurant_id\", params.restaurant_id);\n    return this.request<{ data: any[]; total: number; page: number; totalPages: number }>(\n      `/admin/vouchers?${query}`\n    );\n  }\n\n  async manualValidateVoucher(id: string) {\n    return this.request<any>(`/admin/vouchers/${id}/validate`, { method: \"POST\" });\n  }\n\n  // Audit Logs\n  async getAuditLogs(params?: { page?: number; limit?: number; action?: string; admin_id?: string }) {\n    const query = new URLSearchParams();\n    if (params?.page) query.set(\"page\", params.page.toString());\n    if (params?.limit) query.set(\"limit\", params.limit.toString());\n    if (params?.action) query.set(\"action\", params.action);\n    if (params?.admin_id) query.set(\"admin_id\", params.admin_id);\n    return this.request<{ data: any[]; total: number; page: number; totalPages: number }>(\n      `/admin/audit-logs?${query}`\n    );\n  }\n}\n\nexport const adminApi = new AdminApiClient(BACKEND_URL);\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 203, "column": 0}, "map": {"version":3,"sources":["file:///C:/Prom/mvp-roc/admin/app/login/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport { adminApi } from \"../lib/api\";\nimport { ShieldCheck, Eye, EyeSlash } from \"@phosphor-icons/react\";\n\nexport default function AdminLoginPage() {\n  const router = useRouter();\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [showPassword, setShowPassword] = useState(false);\n  const [error, setError] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError(\"\");\n    setLoading(true);\n\n    try {\n      await adminApi.login(email, password);\n      router.push(\"/\");\n    } catch (err: any) {\n      setError(err.message || \"Erro ao fazer login\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"flex min-h-screen items-center justify-center bg-[var(--color-admin-sidebar)] px-4\">\n      <div className=\"w-full max-w-md\">\n        <div className=\"mb-8 text-center\">\n          <div className=\"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-2xl bg-[var(--color-roc-primary)]\">\n            <ShieldCheck size={32} weight=\"fill\" className=\"text-white\" />\n          </div>\n          <h1 className=\"text-2xl font-bold text-white\">ROC Admin</h1>\n          <p className=\"mt-1 text-sm text-slate-400\">Painel Administrativo</p>\n        </div>\n\n        <form\n          onSubmit={handleSubmit}\n          className=\"rounded-2xl bg-white p-8 shadow-medium\"\n        >\n          {error && (\n            <div className=\"mb-4 rounded-lg bg-red-50 border border-red-200 p-3 text-sm text-red-600\">\n              {error}\n            </div>\n          )}\n\n          <div className=\"mb-4\">\n            <label className=\"mb-1.5 block text-sm font-medium text-[var(--color-text-dark)]\">\n              Email\n            </label>\n            <input\n              type=\"email\"\n              value={email}\n              onChange={(e) => setEmail(e.target.value)}\n              required\n              className=\"w-full rounded-lg border border-[var(--color-border)] px-4 py-3 text-sm outline-none transition-colors focus:border-[var(--color-roc-primary)] focus:ring-2 focus:ring-[var(--color-roc-primary)]/20\"\n              placeholder=\"admin@rocpassaporte.com.br\"\n            />\n          </div>\n\n          <div className=\"mb-6\">\n            <label className=\"mb-1.5 block text-sm font-medium text-[var(--color-text-dark)]\">\n              Senha\n            </label>\n            <div className=\"relative\">\n              <input\n                type={showPassword ? \"text\" : \"password\"}\n                value={password}\n                onChange={(e) => setPassword(e.target.value)}\n                required\n                className=\"w-full rounded-lg border border-[var(--color-border)] px-4 py-3 pr-12 text-sm outline-none transition-colors focus:border-[var(--color-roc-primary)] focus:ring-2 focus:ring-[var(--color-roc-primary)]/20\"\n                placeholder=\"Sua senha\"\n              />\n              <button\n                type=\"button\"\n                onClick={() => setShowPassword(!showPassword)}\n                className=\"absolute right-3 top-1/2 -translate-y-1/2 text-[var(--color-text-medium)] hover:text-[var(--color-text-dark)]\"\n              >\n                {showPassword ? <EyeSlash size={20} /> : <Eye size={20} />}\n              </button>\n            </div>\n          </div>\n\n          <button\n            type=\"submit\"\n            disabled={loading}\n            className=\"w-full rounded-lg bg-[var(--color-roc-primary)] py-3 text-sm font-semibold text-white transition-colors hover:bg-[var(--color-roc-primary-dark)] disabled:opacity-50\"\n          >\n            {loading ? \"Entrando...\" : \"Entrar\"}\n          </button>\n        </form>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AAAA;AAAA;AALA;;;;;;AAOe,SAAS;IACtB,MAAM,SAAS,IAAA,wJAAS;IACxB,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,0NAAQ,EAAC;IACnC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,0NAAQ,EAAC;IACzC,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,0NAAQ,EAAC;IACjD,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,0NAAQ,EAAC;IACnC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,0NAAQ,EAAC;IAEvC,MAAM,eAAe,OAAO;QAC1B,EAAE,cAAc;QAChB,SAAS;QACT,WAAW;QAEX,IAAI;YACF,MAAM,sIAAQ,CAAC,KAAK,CAAC,OAAO;YAC5B,OAAO,IAAI,CAAC;QACd,EAAE,OAAO,KAAU;YACjB,SAAS,IAAI,OAAO,IAAI;QAC1B,SAAU;YACR,WAAW;QACb;IACF;IAEA,qBACE,uPAAC;QAAI,WAAU;kBACb,cAAA,uPAAC;YAAI,WAAU;;8BACb,uPAAC;oBAAI,WAAU;;sCACb,uPAAC;4BAAI,WAAU;sCACb,cAAA,uPAAC,wMAAW;gCAAC,MAAM;gCAAI,QAAO;gCAAO,WAAU;;;;;;;;;;;sCAEjD,uPAAC;4BAAG,WAAU;sCAAgC;;;;;;sCAC9C,uPAAC;4BAAE,WAAU;sCAA8B;;;;;;;;;;;;8BAG7C,uPAAC;oBACC,UAAU;oBACV,WAAU;;wBAET,uBACC,uPAAC;4BAAI,WAAU;sCACZ;;;;;;sCAIL,uPAAC;4BAAI,WAAU;;8CACb,uPAAC;oCAAM,WAAU;8CAAiE;;;;;;8CAGlF,uPAAC;oCACC,MAAK;oCACL,OAAO;oCACP,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,KAAK;oCACxC,QAAQ;oCACR,WAAU;oCACV,aAAY;;;;;;;;;;;;sCAIhB,uPAAC;4BAAI,WAAU;;8CACb,uPAAC;oCAAM,WAAU;8CAAiE;;;;;;8CAGlF,uPAAC;oCAAI,WAAU;;sDACb,uPAAC;4CACC,MAAM,eAAe,SAAS;4CAC9B,OAAO;4CACP,UAAU,CAAC,IAAM,YAAY,EAAE,MAAM,CAAC,KAAK;4CAC3C,QAAQ;4CACR,WAAU;4CACV,aAAY;;;;;;sDAEd,uPAAC;4CACC,MAAK;4CACL,SAAS,IAAM,gBAAgB,CAAC;4CAChC,WAAU;sDAET,6BAAe,uPAAC,kMAAQ;gDAAC,MAAM;;;;;qEAAS,uPAAC,wLAAG;gDAAC,MAAM;;;;;;;;;;;;;;;;;;;;;;;sCAK1D,uPAAC;4BACC,MAAK;4BACL,UAAU;4BACV,WAAU;sCAET,UAAU,gBAAgB;;;;;;;;;;;;;;;;;;;;;;;AAMvC"}}]
}